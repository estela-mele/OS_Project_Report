<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Script Analysis - mail-format.sh</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>Script Analysis: <code>mail-format.sh</code></h1>
    </header>

    <section>
      <h2>Purpose</h2>
      <p>This Bash script formats email content by removing carets, normalizing spacing, and folding excessively long lines to 70 characters. It demonstrates effective use of <code>sed</code>, <code>tr</code>, and <code>fold</code>.</p>
    </section>

    <section>
      <h2>Script Code</h2>
      <pre><code class="bash">#!/bin/bash
# mail-format.sh: Cleans up email formatting.
ARGS=1
E_BADARGS=85
E_NOFILE=86

echo "== Script Start =="

if [ $# -ne $ARGS ]; then
  echo "Usage: $(basename $0) filename"
  exit $E_BADARGS
fi

if [ -f "$1" ]; then
  file_name=$1
  echo "File found: $file_name"
else
  echo "File \"$1\" does not exist."
  exit $E_NOFILE
fi

MAXWIDTH=70

echo "== Original File Content =="
cat "$file_name"

echo "== After sed script (cleaning carets and spacing) =="
cat "$file_name" | tr '\t' ' ' | sed 's/>//g; s/^[ \t]*//; s/[ \t]*$//'

echo "== After folding to $MAXWIDTH characters =="
cat "$file_name" | tr '\t' ' ' | sed 's/>//g; s/^[ \t]*//; s/[ \t]*$//' | fold --width=$MAXWIDTH

echo "== Script End =="
exit $?</code></pre>
    </section>

    <section>
      <h2>Sample Input (email.txt)</h2>
      <pre><code>&gt; This   is     a    test message with &gt; many carets.
        It    has     tabs     and     inconsistent      spacing.
Thisisaveryveryverylonglinewithoutanyspaceswhichneedstobefolded.
</code></pre>
    </section>

    <section>
      <h2>Intermediate Output</h2>
      <pre><code>== Script Start ==
File found: email.txt
== Original File Content ==
&gt; This   is     a    test message with &gt; many carets.
        It    has     tabs     and     inconsistent      spacing.
Thisisaveryveryverylonglinewithoutanyspaceswhichneedstobefolded.
== After sed script (cleaning carets and spacing) ==
This   is     a    test message with  many carets.
It    has     tabs     and     inconsistent      spacing.
Thisisaveryveryverylonglinewithoutanyspaceswhichneedstobefolded.
== After folding to 70 characters ==
This   is     a    test message with  many carets.
It    has     tabs     and     inconsistent      spacing.
Thisisaveryveryverylonglinewithoutanyspaceswh
ichneedstobefolded.
== Script End ==
</code></pre>
    </section>

    <section>
      <h2>Conclusion</h2>
      <p>This script effectively demonstrates how to preprocess and clean text using basic Bash utilities. It replaces tabs, removes carets, trims spaces, and folds long lines, making it useful for cleaning email-like text files.</p>
    </section>
  </div>
</body>
</html>
